<?xml version="1.0"?>
<launch>

    <param name="use_sim_time" value="true" />

    <!-- arguments -->
    <arg name="domain_path"        default="$(find rosplan_planning_system)/common/rosplan_planning_system/domain_robot_delivery.pddl" />
    <arg name="robust_domain_path" default="$(find rosplan_planning_system)/common/rosplan_planning_system/domain_robot_delivery_robust.pddl" />
    <arg name="init_problem_path"  default="$(find rosplan_planning_system)/common/rosplan_planning_system/problems_deadlines_250/problem_1goal_2rob_23wps_deadline250.pddl" /> 
    <arg name="problem_path"       default="$(find rosplan_planning_system)/common/rosplan_planning_system/problem.pddl" />
    <arg name="max_parameters"     default="2" />
    <arg name="stn_timeout"        default="60" />
    <arg name="timeout_actions"         default="true" />
    <arg name="action_timeout_fraction" default="0.0" />
    <arg name="experiment_batch" default="1" />

    <!-- knowledge base -->
    <node name="rosplan_knowledge_base" pkg="rosplan_knowledge_base" type="knowledgeBase" respawn="false" output="screen">
        <param name="domain_path"   value="$(arg domain_path)" />
        <param name="problem_path"  value="$(arg init_problem_path)" />
        <param name="database_path" value="$(find rosplan_knowledge_base)/common/mongoDB/" />
        <param name="use_unknowns"  value="false" />
    </node>

    <node name="coordinator_non_adaptable" pkg="rosplan_planning_system" type="replan_loop.py" output="screen" required="true" >
        <param name="problem_path" type="str" value="$(arg init_problem_path)" />
        <param name="experiment_batch"       value="$(arg experiment_batch)" />
    </node>

  <node name="sim_clock" pkg="sim_clock" type="simclock" required="true" >
    </node>

    <!-- problem generation -->
    <include file="$(find rosplan_planning_system)/launch/includes/problem_interface.launch">
        <arg name="domain_path"      value="$(arg domain_path)" />
        <arg name="problem_path"     value="$(arg problem_path)" />
    </include>

     <!-- planner interface -->
     <include file="$(find rosplan_planning_system)/launch/includes/planner_interface.launch">
         <arg name="domain_path"          value="$(arg domain_path)" />
         <arg name="problem_path"         value="$(arg problem_path)" />
         <arg name="data_path"            value="$(find rosplan_planning_system)/common/rosplan_planning_system/" />
         <arg name="planner_command"      value="timeout 120 $(find rosplan_planning_system)/common/bin/popf DOMAIN PROBLEM" />
     </include>

    <!-- plan parsing -->
    <include file="$(find rosplan_planning_system)/launch/includes/parsing_interface.launch">
         <arg name="epsilon_time" value="1.0" />
    </include>

    <!-- STN_tool-->
    <include file="$(find rosplan_planning_system)/launch/includes/stn_tool.launch">
        <arg name="robust_domain_path" value="$(arg robust_domain_path)" />
        <arg name="problem_path"       value="$(arg problem_path)" />
        <arg name="max_parameters"       value="$(arg max_parameters)" />
        <arg name="stn_timeout"       value="$(arg stn_timeout)" />
    </include>

    <!-- plan dispatch -->
    <include file="$(find rosplan_planning_system)/launch/includes/dispatch_interface.launch">
        <arg name="plan_topic" value="/robust_plan" />
        <arg name="display_edge_type"       value="false" />
        <arg name="timeout_actions"         value="$(arg timeout_actions)" />
        <arg name="action_timeout_fraction" value="$(arg action_timeout_fraction)" />
    </include>

<!-- sim actions -->

    <include file="$(find rosplan_planning_system)/launch/includes/simulated_action.launch" >
        <arg name="pddl_action_name" value="goto_waypoint" />
        <!--arg name="action_duration" value="5" /-->

    </include>

    <include file="$(find rosplan_planning_system)/launch/includes/simulated_action.launch" >
        <arg name="pddl_action_name" value="localise" />
        <arg name="action_duration" value="119" />
        <arg name="action_probability" value="0.95" />
    </include>

    <include file="$(find rosplan_planning_system)/launch/includes/simulated_action.launch" >
        <arg name="pddl_action_name" value="dock" />
        <arg name="action_duration" value="119" />
    </include>

    <include file="$(find rosplan_planning_system)/launch/includes/simulated_action.launch" >
        <arg name="pddl_action_name" value="undock" />
        <arg name="action_duration" value="19" />
    </include>

    <include file="$(find rosplan_planning_system)/launch/includes/simulated_action.launch" >
        <arg name="pddl_action_name" value="ask_unload" />
        <arg name="action_duration" value="19" />
    </include>

    <include file="$(find rosplan_planning_system)/launch/includes/simulated_action.launch" >
        <arg name="pddl_action_name" value="wait_load_at_printer" />
        <arg name="action_duration" value="60" />
        <arg name="action_duration_stddev" value="20" />
        <arg name="action_probability" value="0.95" />
    </include>

    <include file="$(find rosplan_planning_system)/launch/includes/simulated_action.launch" >
        <arg name="pddl_action_name" value="wait_unload" />
        <arg name="action_duration" value="60" />
        <arg name="action_duration_stddev" value="20" />
        <arg name="action_probability" value="0.95" />
    </include>

    <include file="$(find rosplan_planning_system)/launch/includes/simulated_action.launch" >
        <arg name="pddl_action_name" value="ditch" />
        <arg name="action_duration" value="4" />
    </include>
</launch>







